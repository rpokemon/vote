<% locals.require_auth = !locals.responses %>
<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
    <script src="https://cdn.jsdelivr.net/npm/handsontable@6.2.2/dist/handsontable.full.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/handsontable@6.2.2/dist/handsontable.full.min.css" rel="stylesheet" media="screen">
</head>
<body class="container">

<header class="fixed-top">
    <% include ../partials/header %>
</header>

<main>
    <section class="d-flex flex-column justify-content-center" style="height: 100vh">
        <div class="">
            <div class="jumbotron">
                <h1 class="display-4"><%= survey_name %> - Results</h1>

                <% if (require_auth) { %>
                    <!-- authentication UI -->
                    <% include ../partials/authentication %>
                <% } else { %>
                    <!-- TODO HANDLE RESPONSES -->
                    <div id="results" style="overflow: hidden; height: 50vh"></div>
                <% } %>   
            </div>
        </div>
    </section>

</main>

<footer>
    <% include ../partials/footer %>
</footer>

</body>
<script>
var data = <%- JSON.stringify(responses) %>;

$(document).ready(function () {
    var container = $('#results')[0];
    var hot = new Handsontable(container, {
        data: data,
        colHeaders: function(index){
            return `q${index+1}`
        },
        rowHeaders: true,
        dropdownMenu: true
    });
});
</script>
</html>